<!DOCTYPE html>
<html>
<head>
    <title>Forensic Report - {{ report.case_name }}</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; background: #0F172A; color: #E2E8F0; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { background: linear-gradient(135deg, #1E293B, #334155); padding: 30px; border-radius: 10px; margin-bottom: 30px; }
        .section { background: #1E293B; margin: 20px 0; padding: 25px; border-radius: 8px; border: 1px solid #475569; }
        .finding { border-left: 4px solid; padding: 15px; margin: 15px 0; background: rgba(30, 41, 59, 0.5); border-radius: 5px; }
        .finding.critical { border-color: #EF4444; background: rgba(239, 68, 68, 0.1); }
        .finding.high { border-color: #F59E0B; background: rgba(245, 158, 11, 0.1); }
        .finding.medium { border-color: #3B82F6; background: rgba(59, 130, 246, 0.1); }
        .finding.low { border-color: #10B981; background: rgba(16, 185, 129, 0.1); }
        .finding.info { border-color: #00FFFF; background: rgba(0, 255, 255, 0.1); }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        th, td { border: 1px solid #475569; padding: 12px; text-align: left; }
        th { background: #334155; color: #00FFFF; font-weight: bold; }
        .accent { color: #00FFFF; }
        .meta { color: #94A3B8; font-size: 0.9em; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="accent">üîç Crow Eye Forensic Analysis Report</h1>
            <div class="meta">
                <p><strong>Case:</strong> {{ report.case_name }}</p>
                <p><strong>Examiner:</strong> {{ report.examiner }}</p>
                <p><strong>Generated:</strong> {{ report.created_at.strftime('%Y-%m-%d %H:%M:%S UTC') }}</p>
                {% if report.time_range_start %}
                <p><strong>Analysis Period:</strong> {{ report.time_range_start.strftime('%Y-%m-%d') }} to {{ report.time_range_end.strftime('%Y-%m-%d') }}</p>
                {% endif %}
            </div>
        </div>
        
        <div class="section">
            <h2 class="accent">üìã Executive Summary</h2>
            <p>{{ report.executive_summary | replace('
', '<br>') }}</p>
        </div>
        
        <div class="section">
            <h2 class="accent">üîç Key Findings ({{ report.findings | length }})</h2>
            {% for severity, findings_list in findings_by_severity.items() %}
                {% if findings_list %}
                    <h3>{{ severity.title() }} Severity ({{ findings_list | length }})</h3>
                    {% for finding in findings_list %}
                        <div class="finding {{ finding.severity.value }}">
                            <h4>{{ finding.title }}</h4>
                            <p class="meta">
                                <strong>Confidence:</strong> {{ "%.1f" | format(finding.confidence * 100) }}% | 
                                <strong>Artifact:</strong> {{ finding.artifact_type | title }}
                            </p>
                            <p>{{ finding.description }}</p>
                            {% if finding.iocs %}
                                <p><strong>IOCs:</strong> <code>{{ finding.iocs | join(', ') }}</code></p>
                            {% endif %}
                            {% if finding.recommendations %}
                                <p><strong>Recommendations:</strong></p>
                                <ul>
                                    {% for rec in finding.recommendations %}
                                        <li>{{ rec }}</li>
                                    {% endfor %}
                                </ul>
                            {% endif %}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endfor %}
        </div>
        
        <div class="section">
            <h2 class="accent">üìä Analysis Statistics</h2>
            <table>
                <tr><th>Metric</th><th>Value</th></tr>
                {% for key, value in report.statistics.items() %}
                    <tr><td>{{ key.replace('_', ' ').title() }}</td><td>{{ value }}</td></tr>
                {% endfor %}
            </table>
        </div>
        
        <div class="section">
            <h2 class="accent">üîß Tool Information</h2>
            <p class="meta">
                Report generated by {{ report.metadata.tool_name }} v{{ report.metadata.tool_version }}<br>
                Databases analyzed: {{ report.metadata.databases_analyzed | join(', ') }}
            </p>
        </div>
    </div>
</body>
</html>